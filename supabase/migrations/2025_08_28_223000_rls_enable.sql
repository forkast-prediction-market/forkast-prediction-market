-- ============================================================
-- 0007_rls_enable.sql - Enable Row Level Security
-- ============================================================
-- Enable RLS on all public tables

-- Enable RLS on core blockchain tables
ALTER TABLE markets
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE events
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE tags
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE event_tags
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE outcomes
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE sync_status
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE conditions
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE user_position_balances
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE order_fills
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE orders_matched_global
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE market_open_interest
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE global_open_interest
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE position_splits
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE position_merges
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE redemptions
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE market_resolutions
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE sports_games
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE sports_markets
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE fpmms
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE collaterals
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE fpmm_pool_memberships
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE global_usdc_balance
  ENABLE ROW LEVEL SECURITY;

-- Enable RLS on authentication tables
ALTER TABLE users
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE sessions
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE accounts
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE verifications
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE wallets
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE bookmarks
  ENABLE ROW LEVEL SECURITY;

-- Enable RLS on comment-related tables
ALTER TABLE comments
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE comment_likes
  ENABLE ROW LEVEL SECURITY;
ALTER TABLE comment_reports
  ENABLE ROW LEVEL SECURITY;
